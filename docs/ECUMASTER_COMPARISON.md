# Сравнение PMU-30 с Ecumaster PMU

**Дата:** 2025-12-26
**Версия документа Ecumaster:** 101.1.5
**Модели Ecumaster:** PMU-16, PMU-16DL, PMU-16AS, PMU-24DL

---

## 1. Аппаратные характеристики

| Параметр | Ecumaster PMU-16/24 | PMU-30 | Статус |
|----------|---------------------|--------|--------|
| **Выходы High-Side** | 10×25A + 6×15A (PMU-16) | 30×40A (PROFET) | ✅ Лучше |
| **Выходы Low-Side** | 6×1A (только AS) | — | ❌ Нет |
| **H-Bridge** | — | 4× dual (30A) | ✅ Дополнительно |
| **Аналоговые входы** | 16× (0-5V/0-20V) | 20× (10-bit) | ✅ Больше |
| **Цифровые входы** | — (через analog) | 8× выделенных | ✅ Дополнительно |
| **Разрешение АЦП** | 10-bit (0-5V), 12-bit (0-20V) | 10-bit | ⚠️ Меньше для 20V |
| **Диапазон напряжений** | 6-22V | Не указан | ⚠️ Проверить |
| **Pull-up/Pull-down** | 10K селектируемый | Есть | ✅ OK |
| **+5V выход** | 400-500mA | Не указан | ⚠️ Проверить |
| **Общий ток** | 150A (PMU-16), 200A (AS) | Не указан | ⚠️ Проверить |

---

## 2. CAN Bus

| Параметр | Ecumaster PMU | PMU-30 | Статус |
|----------|---------------|--------|--------|
| **Кол-во CAN шин** | 2× CAN 2.0 A/B | 2× CAN FD + 2× CAN 2.0 | ✅ Лучше |
| **Скорости** | 125/250/500/1000 kbps | До 5 Mbps (CAN FD) | ✅ Лучше |
| **CAN1 скорость** | Фиксированная 1Mbps | Настраиваемая | ✅ Гибче |
| **Терминация** | CAN1 нет, CAN2 программная | Программная на всех | ✅ Лучше |
| **CAN Message Objects** | До 100 входящих | До 32 | ⚠️ Меньше |
| **Bit masking** | Да | Да | ✅ OK |
| **DBC/CANX импорт** | Да | Да | ✅ OK |
| **Compound messages** | Да (multiplexed) | Да | ✅ OK |
| **Byte order** | Intel/Motorola | Intel/Motorola | ✅ OK |

### Поддержка CAN клавиатур

| Клавиатура | Ecumaster PMU | PMU-30 | Статус |
|------------|---------------|--------|--------|
| Ecumaster 4/6/8/12 keys | ✅ 2 шт | ❌ | ❌ Нет |
| LifeRacing PDU Keypad | ✅ | ❌ | ❌ Нет |
| MoTeC/RaceGrade | ✅ 1 шт | ❌ | ❌ Нет |
| Grayhill | ✅ 1 шт | ❌ | ❌ Нет |
| BlinkMarine PKP-2600/2800 | ❌ | ✅ | ✅ Уникально |

---

## 3. Логические функции

| Параметр | Ecumaster PMU | PMU-30 | Статус |
|----------|---------------|--------|--------|
| **Кол-во функций** | 100 | 100 | ✅ OK |
| **Кол-во операций** | 250 | ~64 типов | ⚠️ Другая архитектура |
| **Частота обновления** | 500 Hz | 500 Hz | ✅ OK |

### Логические операции

| Операция | Ecumaster | PMU-30 | Статус |
|----------|-----------|--------|--------|
| AND | ✅ | ✅ | ✅ OK |
| OR | ✅ | ✅ | ✅ OK |
| XOR | ✅ | ✅ | ✅ OK |
| NOT | ✅ (IsFalse) | ✅ | ✅ OK |
| NAND | ❌ | ✅ | ✅ Дополнительно |
| NOR | ❌ | ✅ | ✅ Дополнительно |
| IsTrue | ✅ | ❌ | ⚠️ Проверить |
| =, ≠, <, ≤, >, ≥ | ✅ | ✅ | ✅ OK |
| in_range | ❌ | ✅ | ✅ Дополнительно |
| Flash | ✅ | ✅ | ✅ OK |
| Pulse | ✅ | ✅ (retriggerable) | ✅ OK |
| Toggle | ✅ | ✅ | ✅ OK |
| Set/Reset Latch | ✅ | ✅ | ✅ OK |
| Hysteresis | ✅ | ✅ (с полярностью) | ✅ OK |
| Changed | ✅ | ✅ (Rising/Falling) | ✅ OK |

---

## 4. Обработка данных

| Параметр | Ecumaster PMU | PMU-30 | Статус |
|----------|---------------|--------|--------|
| **PID контроллеры** | Да | 16 макс. | ✅ OK |
| **PID anti-windup** | Не указано | Да | ✅ Лучше |
| **PID derivative filter** | Не указано | Да | ✅ Лучше |
| **Таблицы 2D** | Да | До 16 точек | ✅ OK |
| **Таблицы 3D** | Да | До 16×16 | ✅ OK |
| **Таймеры** | Да | 16 макс. | ✅ OK |
| **Режимы таймеров** | Не указано | Count up/down | ✅ OK |
| **Switch каналы** | Да | Да (multi-position) | ✅ OK |
| **Number (Math)** | Да | 11 операций | ✅ OK |
| **Lua скрипты** | ❌ | 8 скриптов × 32KB | ✅ Уникально |

### Math операции (Number channels)

| Операция | Ecumaster | PMU-30 | Статус |
|----------|-----------|--------|--------|
| Constant | ✅ | ✅ | ✅ OK |
| Add (+) | ✅ | ✅ | ✅ OK |
| Subtract (-) | ✅ | ✅ | ✅ OK |
| Multiply (*) | ✅ | ✅ | ✅ OK |
| Divide (/) | ✅ | ✅ | ✅ OK |
| Modulo (%) | ❌ | ✅ | ✅ Дополнительно |
| Min | ✅ | ✅ | ✅ OK |
| Max | ✅ | ✅ | ✅ OK |
| Average | ✅ | ✅ | ✅ OK |
| Abs | ✅ | ✅ | ✅ OK |
| Scale | ✅ | ✅ | ✅ OK |
| Clamp | ✅ | ✅ | ✅ OK |
| Lookup | ✅ | ✅ (2-5 inputs) | ✅ OK |

---

## 5. Защита

| Параметр | Ecumaster PMU | PMU-30 | Статус |
|----------|---------------|--------|--------|
| **Overcurrent** | Да, на выход | Да, на выход + инраш | ✅ Лучше |
| **Undercurrent** | Да | Open-load detection | ✅ OK |
| **Thermal shutdown** | Да | Да, на выход | ✅ OK |
| **Short-circuit** | Да | Да (SC state) | ✅ OK |
| **Reverse polarity** | До 16V | Не указано | ⚠️ Проверить |
| **Inrush current** | Soft Start | Soft Start + Inrush limit | ✅ Лучше |
| **Battery monitoring** | Да | Да (min/max thresholds) | ✅ OK |
| **Temperature sensors** | 3× на плате (TL, TR, TF) | 2× на плате (L, R) | ⚠️ Меньше |
| **Inertia switch** | Да (акселерометр/гироскоп) | 3D акселерометр + гироскоп | ✅ OK |

### Статусы выходов

| Статус | Ecumaster | PMU-30 | Описание |
|--------|-----------|--------|----------|
| OFF | 0 | 0 | Выход выключен |
| ACTIVE/ON | 1 | 1 | Выход активен |
| UNDERCURRENT | 2 | OL (5) | Нет нагрузки |
| OVERCURRENT | 3 | OC (2) | Превышение тока |
| THERMAL | 7 | OT (3) | Перегрев |
| SHORT-CIRCUIT | — | SC (4) | Короткое замыкание |
| PWM | — | 6 | PWM режим |
| DISABLED | — | 7 | Отключен программно |

---

## 6. Логирование

| Параметр | Ecumaster PMU | PMU-30 | Статус |
|----------|---------------|--------|--------|
| **Память логов** | 256 MB | 512 MB | ✅ Лучше |
| **Скорость логирования** | До 500 Hz | 50-500 Hz | ✅ OK |
| **Custom Log** | Да | Да | ✅ OK |
| **PC Logging** | До 500 Hz | Да (telemetry) | ✅ OK |
| **RTC** | Да (суперконденсатор 3 дня) | Не указано | ⚠️ Проверить |

---

## 7. Специальные модули

| Модуль | Ecumaster PMU | PMU-30 | Статус |
|--------|---------------|--------|--------|
| **Wipers Module** | O8 + park switch | H-Bridge + PID park | ✅ Лучше |
| **Blinkers Module** | Да | Да | ✅ OK |
| **Delayed turn off** | Да | Не указано | ⚠️ Проверить |
| **Autosaved channels** | Да | Не указано | ⚠️ Проверить |
| **Multiple PMUs** | До 5 шт | Не указано | ⚠️ Проверить |

---

## 8. PWM и Soft Start

| Параметр | Ecumaster PMU | PMU-30 | Статус |
|----------|---------------|--------|--------|
| **PWM частота** | 4-400 Hz | 1 Hz - 20 kHz | ✅ Шире диапазон |
| **PWM разрешение** | Не указано | 0.1% (0-1000) | ✅ OK |
| **PWM выходы** | Только 25A | Все PROFET | ✅ Больше |
| **Soft Start** | 25A выходы | Все выходы (0-5000ms) | ✅ Лучше |
| **Duty от канала** | Да | Да | ✅ OK |

---

## 9. Коммуникации

| Интерфейс | Ecumaster PMU | PMU-30 | Статус |
|-----------|---------------|--------|--------|
| **CAN** | 2× CAN 2.0 | 4× (2 FD + 2 Classic) | ✅ Лучше |
| **USB** | Через CAN адаптер | USB-C | ✅ Проще |
| **WiFi** | ❌ | AP/STA mode | ✅ Уникально |
| **Bluetooth** | ❌ | Classic + BLE | ✅ Уникально |
| **LIN** | ❌ | LIN 2.x Master/Slave | ✅ Уникально |
| **Web UI** | ❌ | Встроенный | ✅ Уникально |

---

## 10. Итоговое сравнение

### ✅ PMU-30 превосходит Ecumaster PMU

| Область | Преимущество PMU-30 |
|---------|---------------------|
| **Выходы** | 30×40A vs 16×25A - больше мощности |
| **H-Bridge** | 4× моторных выхода - уникально |
| **CAN FD** | До 5Mbps - современный протокол |
| **PWM диапазон** | 1Hz-20kHz vs 4-400Hz - гибче |
| **Логирование** | 512MB vs 256MB - больше памяти |
| **Lua скрипты** | Программируемая логика - уникально |
| **WiFi/BLE** | Беспроводное подключение - уникально |
| **LIN bus** | Дополнительный протокол |
| **PID расширения** | Anti-windup, derivative filter |
| **Логические операции** | NAND, NOR, in_range, Modulo |

### ⚠️ Требует внимания/добавления

| Область | Что отсутствует в PMU-30 |
|---------|--------------------------|
| **Low-Side выходы** | Ecumaster AS имеет 6×1A low-side |
| **CAN клавиатуры** | Ecumaster, MoTeC, Grayhill не поддержаны |
| **RTC** | Real-time clock с backup |
| **Delayed turn off** | Задержка выключения устройства |
| **Autosaved channels** | Сохранение значений при перезагрузке |
| **АЦП 12-bit** | Для входов 0-20V (PMU-24) |
| **Reverse polarity** | Явная защита до 16V |
| **CAN Message Objects** | 100 vs 32 - меньше |
| **Multiple PMUs** | Работа до 5 устройств |

### ❌ Отсутствует в PMU-30

1. **Поддержка CAN клавиатур Ecumaster** (4/6/8/12 кнопок)
2. **MoTeC/RaceGrade keypad**
3. **Grayhill keypad**
4. **LifeRacing PDU keypad**
5. **Low-side outputs** (для PMU AS совместимости)

---

## 11. Рекомендации по доработке

### Приоритет 1 (Критично для совместимости)

1. Добавить поддержку **CAN клавиатур Ecumaster** (ID 0x18EF5500)
2. Увеличить лимит **CAN Message Objects** до 100
3. Добавить **Delayed turn off** функцию
4. Добавить **Autosaved channels**

### Приоритет 2 (Улучшения)

1. Добавить **RTC с backup** питанием
2. Добавить **Low-side outputs** (программная эмуляция через PROFET)
3. Поддержка **MoTeC/Grayhill keypads**
4. **12-bit ADC** режим для 0-20V входов
5. Поддержка **Multiple PMUs** (до 5 устройств)

### Приоритет 3 (Документация)

1. Указать **рабочий диапазон напряжений**
2. Указать **ток +5V выхода**
3. Документировать **reverse polarity protection**
4. Указать **общий максимальный ток**

---

## Ссылки

- [Ecumaster PMU Manual v101.1.5](https://www.ecumaster.com/files/PMU/)
- [PMU-16 Pinout](https://www.ecumaster.com/files/PMU/PMU-16_Pinout_v1.2.pdf)
- [PMU-16AS Pinout](https://www.ecumaster.com/files/PMU/PMU-16AS_Pinout_v1.3.pdf)
- [PMU-24 Pinout](https://www.ecumaster.com/files/PMU/PMU-24_Pinout_v1.3.pdf)
